<div class="container">
  <div class="title" style="margin-top: 30px">EDIT PROPERTY</div>
  <form #propertyForm="ngForm" (ngSubmit)="updateProperty(propertyForm)">
    <!--Property name field-->

    <div class="row mt-4">
      <mat-form-field appearance="outline" class="col-12">
        <mat-label>Property Name:</mat-label>
        <input
          matInput
          name="propertyName"
          #propertyName="ngModel"
          [(ngModel)]="oldProperty.propertyName"
          required
        />
        <mat-error *ngIf="propertyName.invalid"
          >Property Name is required
        </mat-error>
      </mat-form-field>
    </div>

    <!-- <pop image> -->
    <div class="row mt-4">
      <button
        mat-raised-button
        color="warn"
        type="button"
        (click)="openImagePopup()"
      >
        View Images
      </button>
    </div>
    <!-- Country -->
    <div class="row my-4">
      <mat-form-field class="col-12 col-md-6 col-lg-4" appearance="outline">
        <mat-label for="country">Country:</mat-label>
        <input
          type="text"
          matInput
          [value]="getSelectedCountryName()"
          readonly
          required
        />
      </mat-form-field>

      <!-- City -->

      <mat-form-field class="col-12 col-md-6 col-lg-4" appearance="outline">
        <mat-label>City:</mat-label>
        <input
          type="text"
          matInput
          [value]="getSelectedCityName()"
          readonly
          required
        />
      </mat-form-field>

      <!--Address field-->
      <mat-form-field class="col-12 col-md-6 col-lg-4" appearance="outline">
        <mat-label>Address:</mat-label>
        <input
          matInput
          [(ngModel)]="oldProperty.address"
          name="address"
          required
        />
        <mat-error *ngIf="propertyForm.controls['address']?.errors"
          >Address is required</mat-error
        >
      </mat-form-field>
    </div>

    <div class="row my-4">
      <!-- Category -->
      <mat-form-field class="col-12 col-md-6 col-lg-6" appearance="outline">
        <mat-label>Category:</mat-label>
        <mat-select [(ngModel)]="selectedCategory" name="category" required>
          <mat-option value="">Select Category</mat-option>
          <mat-option
            *ngFor="let category of categories"
            [value]="category.id"
            >{{ category.name }}</mat-option
          >
        </mat-select>
        <mat-error *ngIf="!selectedCategory">Category is required</mat-error>
      </mat-form-field>
      <!--Amenities field-->
      <mat-form-field class="col-12 col-md-6 col-lg-6" appearance="outline">
        <mat-label>Amenities:</mat-label>
        <mat-select
          #selectList
          [(ngModel)]="selectedAmenities"
          multiple
          (selectionChange)="onAmenitySelectionChange($event)"
          name="amenities"
        >
          <mat-option *ngFor="let amenity of amenities" [value]="amenity.id">
            {{ amenity.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="row my-4">
      <!--Bedroom count field-->
      <mat-form-field class="col-6 col-md-4" appearance="outline">
        <mat-label>Bedrooms Count:</mat-label>
        <input
          matInput
          [(ngModel)]="oldProperty.bedroomsCount"
          name="bedroomsCount"
          type="number"
          required
          min="1"
        />
        <mat-error *ngIf="propertyForm.controls['bedroomsCount']?.errors"
          >Bedrooms has a minimum of 1</mat-error
        >
      </mat-form-field>

      <!--Bed count field-->
      <mat-form-field class="col-6 col-md-4" appearance="outline">
        <mat-label>Bed Count</mat-label>
        <input
          matInput
          [(ngModel)]="oldProperty.bedCount"
          name="bedCount"
          type="number"
          required
          min="1"
        />
        <mat-error *ngIf="propertyForm.controls['bedCount']?.errors"
          >Bed Count has a minimum of 1</mat-error
        >
      </mat-form-field>

      <!--Bathroom count field-->
      <mat-form-field class="col-6 col-md-4" appearance="outline">
        <mat-label>Bathrooms Count:</mat-label>
        <input
          matInput
          [(ngModel)]="oldProperty.bathroomsCount"
          name="bathroomsCount"
          type="number"
          required
          min="1"
        />
        <mat-error *ngIf="propertyForm.controls['bathroomsCount']?.errors"
          >Bathrooms Count has a minimum of 1</mat-error
        >
      </mat-form-field>
    </div>

    <div class="row my-4">
      <!--Max Number of Guests-->
      <mat-form-field class="col-6 col-md-6" appearance="outline">
        <mat-label>Max Number of Guests</mat-label>
        <input
          matInput
          [(ngModel)]="oldProperty.maxNumberOfGuests"
          name="maxNumberOfGuests"
          type="number"
          required
          max="16"
          min="1"
        />
        <mat-error *ngIf="propertyForm.controls['maxNumberOfGuests']?.errors"
          >Max Number of Guests must be between 1 and 16.</mat-error
        >
      </mat-form-field>

      <!--Price per night field-->
      <mat-form-field class="col-6 col-md-6" appearance="outline">
        <mat-label>Price per Night:</mat-label>
        <input
          matInput
          [(ngModel)]="oldProperty.pricePerNight"
          name="pricePerNight"
          type="number"
          required
          min="5"
        />
        <mat-error *ngIf="propertyForm.controls['pricePerNight']?.errors"
          >Price per Night has a minimum of 5</mat-error
        >
      </mat-form-field>
    </div>

    <div class="row mt-3">
      <!--Description field-->
      <mat-form-field class="col-12" appearance="outline">
        <mat-label>Description:</mat-label>
        <textarea
          matInput
          [(ngModel)]="oldProperty.description"
          name="description"
          required
        ></textarea>
        <mat-error *ngIf="propertyForm.controls['description']?.errors"
          >Description is required</mat-error
        >
      </mat-form-field>
    </div>

    <div class="row mt-3">
      <button mat-raised-button type="submit" color="warn">
        Update Property
      </button>
    </div>
  </form>
</div>
